{
    "version": 2,
    "name": "Hydra Research Nautilus",
    "inherits": "fdmprinter",
    "metadata": {
        "visible": true,
        "author": "Hydra Research",
        "manufacturer": "Hydra Research",
        "category": "Hydra Research",
        "file_formats": "text/x-gcode",
        "icon": "icon_ultimaker2",
        "platform": "hydra_research_nautilus_platform.stl",
        "has_machine_quality": true,
        "has_materials": true,
        "has_machine_materials": true,
        "has_variant_materials": true,
        "has_variants": true,
        "variants_name": "Tool Cartridge",
        "preferred_variant_name": "X 400",
        "preferred_quality_type": "Normal",
        "machine_extruder_trains":
        {
            "0": "hydra_research_nautilus_extruder"
        }
    },

    "overrides": {
        "machine_name": { "default_value": "Hydra Research Nautilus" },
        "machine_heated_bed": { "default_value": true },
        "machine_width": { "default_value": 209 },
        "machine_height": { "default_value": 220 },
        "machine_depth": { "default_value": 206 },
        "machine_center_is_zero": { "default_value": false },
		    "machine_nozzle_temp_enabled": { "value": true },
        "material_bed_temperature": { "default_value": 50 },
        "retraction_amount": { "default_value": 1 },
        "retraction_speed": { "default_value": 25 },
        "retraction_retract_speed": { "default_value": 35 },
        "retraction_prime_speed": { "default_value": 35 },
        "adhesion_type": { "default_value": "skirt" },
        "machine_head_with_fans_polygon": { "default_value": [[-31,31],[34,31],[34,-40],[-31,-40]] },
        "gantry_height": { "default_value": 28 },
        "machine_max_feedrate_x": { "default_value": 600 },
        "machine_max_feedrate_y": { "default_value": 600 },
        "machine_max_feedrate_z": { "default_value": 40},
        "machine_max_feedrate_e": { "default_value": 4000 },
        "machine_max_acceleration_z": { "default_value": 800 },
        "machine_acceleration": { "default_value": 1300},
        "machine_max_jerk_xy": { "default_value": 8 },
        "machine_max_jerk_z": { "default_value": 8.3 },
        "machine_max_jerk_e": { "default_value": 13.3 },
        "machine_gcode_flavor": { "default_value": "RepRap (RepRap)" },
        "machine_extruder_count": { "default_value": 1 },
        "machine_start_gcode": {
            "default_value": "M291 P\"Tool Cartridge: {varient_name}, Material: {material_name}, and Print Surface: {material_print_surface}\" R\"This Job Uses\" S3\nM104 S{material_print_temperature_layer_0} T0 ; set extruder temp\nM140 S{material_bed_temperature_layer_0} ; set bed temp\nM98 P/sys/probeauto.g ; conduct auto bed level compensation\nG1 X-8 Y20 F6000 ; position over purge bucket\nM190 S{material_bed_temperature_layer_0} ; wait for bed temp\nM109 S{material_print_temperature_layer_0} T0; wait for extruder temp\nM83\nM572 D0 S{pressure_advance_value} ; set material pressure advance value\nT0\n;M221 S95\nM116 ; Wait for temperatures\nG1 E20 F80 ; Prime\nM98 P/sys/wipe.g ; wipe"
			},
        "machine_end_gcode": {
            "default_value": "G1 E-2 F2000 ; retract filament\nM107 ; turn off fan\nG28 Z ; home z\nG1 X200 Y200 F3000 ; move to cooling position\nM140 S50 ; turn off bed\nM104 S0 ; turn off extruder\nG90 ; absolute positioning\nM291 P\"Please wait. Cooling to part removal temperature of {material_part_removal_temperature}C. Open door to speed up cooldown.\" R\"Heatbed Cooling\" S1 T0\nM190 R{material_part_removal_temperature} ; Wait to reach removal temp\nM300 S250 P1000 ; Play notification beep\nM291 P\"You may now remove your part. CAUTION! Print Surface may still be HOT!\" R\"Print Finished.\" S2\nM140 S0; Turn off bed"
			},



		"layer_height_0": { "value": "round(machine_nozzle_size / 1.6, 2)" },
		"line_width": { "value": "round(machine_nozzle_size * 1.125, 3)" },
		"wall_line_width_0": { "value": "machine_nozzle_size" },
		"wall_line_width_x": { "value": "round(line_width, 2)" },
		"infill_line_width": { "value": "round(line_width, 2)" },
		"roofing_line_width": { "value": "machine_nozzle_size" },
		"initial_layer_line_width_factor": { "value": "93" },

		"wall_0_wipe_dist": { "value": "machine_nozzle_size * 2"},
		"infill_wipe_dist": { "value": "machine_nozzle_size * .75"},
		"wall_thickness": { "value": "wall_line_width_0 + wall_line_width_x"},
		"roofing_layer_count": { "value": "1"},
		"top_bottom_thickness": { "value": "wall_line_width_0 + wall_line_width_x" },
		"top_thickness": { "value": "top_bottom_thickness + layer_height" },
		"optimize_wall_printing_order": { "value": "True" },
		"travel_compensate_overlapping_walls_enabled": { "value": "True" },
		"fill_perimeter_gaps": { "value": "'everywhere'" },
		"filter_out_tiny_gaps": { "value": "True" },
		"fill_outline_gaps": { "value": "True" },
		"xy_offset_layer_0": { "value": "machine_nozzle_size * -.25"},
		"z_seam_type": { "value": "'sharpest_corner'"},
		"z_seam_corner": { "value": "'z_seam_corner_inner'"},
		"skin_no_small_gaps_heuristic": { "value": "False" },

    "infill_sparse_density": {
			"description": "Adjusts the density of infill of the print. WARNING: Printing with 100% infill is not recommended as it is quite sensitive to filament diameter/extrusion inconsistency.",
			"maximum_value_warning": "90",
			"maximum_value": "96",
			"value": "20"
		},

		"infill_pattern": { "value": "'cubic' if infill_sparse_density < 95 else 'lines'" },
		"zig_zaggify_infill": { "value": "gradual_infill_steps == 0" },
		"infill_overlap": { "value": "3" },
		"skin_overlap": { "value": "10" },
		"infill_before_walls": { "value": "False" },
		"skin_preshrink": { "value": "machine_nozzle_size * 2" },

		"material_standby_temperature": { "value": "0" },
		"material_bed_temperature_layer_0": {
			"minimum_value_warning": "25",
			"value": "default_material_bed_temperature - 5"
		},
		"retraction_enable": { "value": "True" },
		"retract_at_layer_change": { "value": "True" },
		"retraction_min_travel": { "value": "machine_nozzle_size * 4" },
		"retraction_count_max": { "value": "10" },
		"retraction_extrusion_window": { "value": "1"},
		"retraction_extra_prime_amount": { "value": "coasting_volume" },

		"speed_print": {
			"maximum_value_warning": "205",
			"default_value": 125,
			"value": "math.ceil((speed_volumetric / (line_width * layer_height)) if (speed_volumetric / (line_width * layer_height)) < 125 else 125) "
		},
		"speed_infill": {
			"maximum_value_warning": "205",
			"default_value": 125,
			"value": "speed_print if speed_print < 125 else 125"
		},
		"speed_wall": {
			"maximum_value_warning": "205",
			"default_value": 25,
			"value": "speed_print if speed_print < 25 else 25"
		},
		"speed_wall_0": {
			"maximum_value_warning": "205",
			"default_value": 25,
			"value": "math.ceil(speed_print if speed_print < 25 else speed_wall)"
		},
		"speed_wall_x": {
			"maximum_value_warning": "205",
			"default_value": 50,
			"value": "speed_print if speed_print < speed_wall * 2 else speed_wall * 2"
		},
		"speed_roofing": {
			"maximum_value_warning": "205",
			"default_value": 50,
			"value": "speed_print if speed_print < 50 else 50"
		},
		"speed_topbottom": {
			"maximum_value_warning": "205",
			"default_value": 125,
			"value": "speed_print if speed_print < 125 else 125"
		},
		"speed_support": {
			"maximum_value_warning": "205",
			"default_value": 80,
			"value": "speed_print if speed_print < 80 else 80"
		},
		"speed_travel": {
			"maximum_value_warning": "305",
			"default_value": 200,
			"value": "200"
		},
		"speed_layer_0": {
			"maximum_value_warning": "205",
			"default_value": 20,
			"value": "speed_print if speed_print < 20 else 20"
		},
		"speed_travel_layer_0": {
			"maximum_value_warning": "305",
			"default_value": 150,
			"value": "150"
		},


		"speed_slowdown_layers": { "value": "1" },
		"acceleration_enabled": { "value": "True" },
		"acceleration_print": { "value": "1100" },
		"acceleration_wall": { "value": "700" },
		"acceleration_wall_0": { "value": "500" },
		"acceleration_travel": { "value": "1100"},
		"jerk_enabled": { "value": "True" },
		"jerk_print": { "value": "8" },
		"jerk_wall": { "value": "7" },
		"jerk_wall_0": { "value": "7" },
		"jerk_travel": { "value": "8" },


		"retraction_combing": { "value": "'off'" },
		"retraction_combing_max_distance": { "value": "1" },
		"travel_retract_before_outer_wall": { "value": "True" },
		"travel_avoid_distance": { "value": "machine_nozzle_size * 3.75" },
		"layer_start_x": {"value": "205" },
		"layer_start_y": {"value": "205" },
		"retraction_hop_enabled": { "value": "True" },
		"retraction_hop_only_when_collides": { "value": "True" },
		"travel_avoid_other_parts": { "value": "False" },
		"retraction_hop": { "value": "machine_nozzle_size/2" },
		"retraction_hop_after_extruder_switch": { "value": "True" },

		"cool_fan_full_at_height": { "value": "layer_height_0 + 1 * layer_height" },
		"cool_fan_speed_0": { "value": "0"},
		"cool_fan_speed_min": { "value": "cool_fan_speed" },
        "cool_fan_speed": { "default_value": "50" },
        "cool_min_speed": { "value": "5" },

		"support_angle": { "value": "50" },
        "support_pattern": { "value": "'zigzag'" },
		"support_line_width": { "value": "machine_nozzle_size *.875" },
		"support_interface_line_width": { "value": "machine_nozzle_size * 0.75" },
		"support_interface_pattern": { "value": "'zigzag'" },
        "support_use_towers": { "value": "False" },
		"support_z_distance": { "value": "layer_height" },
        "support_xy_distance": { "value": "wall_line_width_0 * 2" },
        "support_xy_distance_overhang": { "value": "wall_line_width_0" },
		"support_interface_enable": { "value": "True" },
		"support_interface_height": { "value": "machine_nozzle_size * 2.5" },
		"support_fan_enable": { "value": "True" },
		"brim_width": { "default_value": 5 },
		"skirt_gap":{ "value": "line_width * 3" },
		"support_brim_width": { "default_value": 5},
		"support_fan_enable": { "value": "True" },
		"support_supported_skin_fan_speed": { "value": "cool_fan_speed + 20 if cool_fan_speed < 80 else 100 - cool_fan_speed + cool_fan_speed" },

		"slicing_tolorance": { "value": "'middle'" },
		"minimum_polygon_circumference": { "value": "machine_nozzle_size * 2 " },
		"coasting_enable": { "value": "True" },
		"coasting_volume": { "value": "(machine_nozzle_size ** 3) / 2" },
		"coasting_min_volume": { "value": "(machine_nozzle_size ** 3) * 2" },
		"coasting_speed": { "value": "speed_wall_0" },
		"bridge_settings_enabled": { "value": "True" },
		"bridge_enable_more_layers": { "value": "True" },
		"bridge_wall_speed": { "value": "speed_print if speed_print < 30 else 30" },
    "bridge_skin_speed": { "value": "speed_print if speed_print < 30 else 30" },
		"bridge_fan_speed": { "value": "cool_fan_speed + 20 if cool_fan_speed < 80 else 100 - cool_fan_speed + cool_fan_speed" },
		"bridge_fan_speed_2": { "value": "cool_fan_speed" },
    "bridge_skin_speed_2": { "value": "speed_print if speed_print < 60 else 60"},
		"bridge_fan_speed_3": { "value": "cool_fan_speed" },
    "bridge_skin_speed_3": { "value": "speed_print if speed_print < 100 else 100"}
    },

	"settings":
    {
		"resolution":
        {
			"children":
			{
				"varient_name":
                {
                    "label": "Tool Cartridge",
                    "description": "Name of Tool Cartridge, used for gcode output metadata",
                    "unit": "",
                    "type": "str",
                    "default_value": "Unknown",
                    "settable_per_mesh": false
				}
			}
		},
		"material":
		{
			"children":
			{
				"material_part_removal_temperature":
				{
					"label": "Part Removal Temperature",
					"description": "The ideal bed temperature to remove the part after printing.",
					"unit": "°C",
					"minimum_value": "0",
					"type": "float",
					"maximum_value": "110",
					"minimum_value": "0",
                    "minimum_value_warning": "20",
                    "maximum_value_warning": "80",
					"default_value": 50,
					"value": "math.ceil(material_bed_temperature if material_bed_temperature < 55 else 55 + ((material_bed_temperature - 55) *.285))",
					"settable_per_mesh": false,
					"settable_per_extruder": false
				},
				"pressure_advance_value":
				{
					"label": "Pressure Advance Value",
					"description": "Pressure advance aims to compensate for the elasticity of the filament and the extruder system. Every material will require a slightly different value. Values between 0.01 and 0.1 are reccomended for most rigid materials, try a higher value for flexible materials.",
					"unit": "",
					"type": "float",
					"default_value": 0.05,
					"minimum_value_warning": ".01",
					"maximum_value_warning": ".2",
					"settable_per_extruder": true,
					"settable_per_mesh": false,
					"minimum_value": "0"
				},
				"speed_volumetric":
                {
                    "label": "Maximum Volumetric Speed",
                    "description": "Maximum volumetric speed allowed for this material. Limits the maximum printing speed to the maximum material volumetric speed.",
                    "unit": "mm³/s",
                    "type": "float",
                    "minimum_value": "0.1",
                    "maximum_value_warning": "25",
                    "maximum_value": "math.sqrt(machine_max_feedrate_x ** 2 + machine_max_feedrate_y ** 2)",
                    "default_value": 15,
                    "settable_per_mesh": true
				},
				"material_name":
                {
                    "label": "Material Name",
                    "description": "Name of material, used for gcode output metadata",
                    "unit": "",
                    "type": "str",
                    "default_value": "Unknown",
					"settable_per_extruder": true,
                    "settable_per_mesh": false
				},
				"material_print_surface":
                {
                    "label": "Reccomended Print Surface",
                    "description": "Reccomended Print Surface for this material. Used for gcode output metadata",
                    "unit": "",
                    "type": "str",
                    "default_value": "Unknown",
                    "settable_per_mesh": false
				}
      }
		}
	}
}
